{% extends 'base/base.html' %}
{% load static %}

{% block title %}Delete Document - {{ document.title }}{% endblock %}

{% block extra_css %}
<style>
    .delete-container {
        max-width: 600px;
        margin: 3rem auto;
    }
    
    .warning-icon {
        font-size: 5rem;
        color: #dc3545;
        animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.5; }
    }
    
    .document-info {
        background: #f8f9fa;
        border-left: 4px solid #dc3545;
        padding: 1rem;
        border-radius: 0.5rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="delete-container">
        <div class="card shadow-lg border-danger">
            <div class="card-header bg-danger text-white">
                <h4 class="mb-0">
                    <i class="fas fa-exclamation-triangle"></i> Confirm Deletion
                </h4>
            </div>
            <div class="card-body text-center">
                <div class="warning-icon mb-4">
                    <i class="fas fa-trash-alt"></i>
                </div>
                
                <h3 class="mb-4">Are you sure you want to delete this document?</h3>
                
                <div class="document-info text-start mb-4">
                    <h5 class="mb-3">
                        <i class="fas fa-file-alt text-danger"></i> Document Details
                    </h5>
                    <p class="mb-2">
                        <strong>Title:</strong> {{ document.title }}
                    </p>
                    <p class="mb-2">
                        <strong>Created:</strong> {{ document.created_at|date:"M d, Y H:i" }}
                    </p>
                    <p class="mb-2">
                        <strong>Word Count:</strong> {{ document.word_count }}
                    </p>
                    <p class="mb-2">
                        <strong>Confidence:</strong> {{ document.confidence_score|floatformat:1 }}%
                    </p>
                    <p class="mb-0">
                        <strong>Status:</strong> 
                        <span class="badge 
                            {% if document.processing_status == 'completed' %}bg-success
                            {% elif document.processing_status == 'processing' %}bg-info
                            {% elif document.processing_status == 'failed' %}bg-danger
                            {% else %}bg-secondary{% endif %}">
                            {{ document.get_processing_status_display }}
                        </span>
                    </p>
                </div>
                
                <div class="alert alert-danger">
                    <i class="fas fa-exclamation-circle"></i>
                    <strong>Warning:</strong> This action cannot be undone. The document and all associated data will be permanently deleted.
                </div>
                
                <form method="POST" class="d-inline">
                    {% csrf_token %}
                    <div class="d-flex justify-content-center gap-3">
                        <a href="{% url 'editor:text_document_list' %}" class="btn btn-secondary btn-lg">
                            <i class="fas fa-arrow-left"></i> Cancel
                        </a>
                        <button type="submit" class="btn btn-danger btn-lg">
                            <i class="fas fa-trash-alt"></i> Yes, Delete Document
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Alternative Actions -->
        <div class="card mt-4 border-info">
            <div class="card-header bg-info text-white">
                <h6 class="mb-0">
                    <i class="fas fa-lightbulb"></i> Alternative Actions
                </h6>
            </div>
            <div class="card-body">
                <p class="mb-3">Instead of deleting, you might want to:</p>
                <div class="d-grid gap-2">
                    <a href="{% url 'editor:export_text_document' document.id %}" class="btn btn-outline-success">
                        <i class="fas fa-download"></i> Export Document First
                    </a>
                    <a href="{% url 'editor:edit_text_document' document.id %}" class="btn btn-outline-primary">
                        <i class="fas fa-edit"></i> Edit Document
                    </a>
                    <a href="{% url 'editor:text_document_list' %}" class="btn btn-outline-secondary">
                        <i class="fas fa-list"></i> Back to Document List
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Confirmation on form submit
    document.querySelector('form').addEventListener('submit', function(e) {
        if (!confirm('Are you absolutely sure? This will permanently delete the document.')) {
            e.preventDefault();
        }
    });
</script>
{% endblock %}
